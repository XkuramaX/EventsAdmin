{"ast":null,"code":"var _jsxFileName = \"/Users/akashaki/personalProjects/AdminPanel/src/components/events/Events.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport config from '../../config.json';\nimport EventsTable from './EventsTable';\nimport CsvDownload from 'react-json-to-csv';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Events(user) {\n  _s();\n\n  // console.log(user)\n  let BaseUrl = config.baseUrl + \"/api/events\";\n  let EventUrl = config.baseUrl + \"/api/events/all\";\n  const [events, setEvents] = useState([]);\n  let key = JSON.parse(localStorage.getItem(\"apiKey\"));\n\n  let fetchData = async url => {\n    let response = await fetch(url, {\n      method: 'GET',\n      // *GET, POST, PUT, DELETE, etc.\n      mode: 'cors',\n      // no-cors, *cors, same-origin\n      cache: 'no-cache',\n      // *default, no-cache, reload, force-cache, only-if-cached\n      // credentials: 'include', // include, *same-origin, omit\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\": key //   'Content-Type': 'application/x-www-form-urlencoded',\n\n      }\n    });\n    let resp = await response.json();\n    return resp;\n  };\n\n  let deleteItem = async url => {\n    let response = await fetch(url, {\n      method: 'DELETE',\n      // *GET, POST, PUT, DELETE, etc.\n      mode: 'cors',\n      // no-cors, *cors, same-origin\n      cache: 'no-cache',\n      // *default, no-cache, reload, force-cache, only-if-cached\n      // credentials: 'include', // include, *same-origin, omit\n      headers: {\n        'Content-Type': 'application/json',\n        \"Authorization\": key //   'Content-Type': 'application/x-www-form-urlencoded',\n\n      }\n    });\n    let resp = await response.json();\n    return resp;\n  };\n\n  const [csvData, setCsvData] = useState([]);\n\n  async function makeCSV(response) {\n    let arr = [];\n    response.map(item => {\n      let obj = {};\n      obj.Name = item.first_name;\n      obj.Phone = item.phone_number;\n      arr.push(obj);\n    });\n    setCsvData(arr);\n  }\n\n  useEffect(() => {\n    fetchData(EventUrl).then(response => {\n      console.log(response);\n\n      if (response.success) {\n        let resp = response.response;\n        makeCSV(resp);\n        console.log(\"success\", response);\n        se(response.response);\n      } else {\n        console.log(response);\n      }\n    });\n  }, []);\n  useEffect(() => {\n    fetchData(LeadUrl + '?page=' + Page.current).then(response => {\n      if (response.success) {\n        console.log(\"success\", response);\n        makeCSV(response.response);\n        setLeads(response.response);\n      } else {\n        console.log(response);\n      }\n    });\n  }, [Page]);\n\n  async function removeItem(item) {\n    let response = await deleteItem(BaseUrl + \"/\" + item._id);\n\n    if (response.success) {\n      setLeads(leads.filter(lead => lead._id !== item._id));\n      console.log(\"remove\");\n      let currentPage = Page.current; //checking pagination of the last item deletion in the last page\n\n      if ((Page.count - 1) % 50 === 0 && Page.current === parseInt((Page.count - 1) / 50)) {\n        currentPage -= 1;\n      }\n\n      if (Page.count % 50 && Page.totalPage != parseInt((Page.count - 1) / 50)) {\n        Page.totalPage -= 1;\n      }\n\n      setPage({\n        count: Page.count - 1,\n        current: currentPage\n      });\n    } else {\n      console.log(\"Cannot delete\");\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container-fluid\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"h3 mb-2 text-gray-800 heading\",\n      children: \"Leads Table\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 21\n    }, this), \" \", /*#__PURE__*/_jsxDEV(CsvDownload, {\n      data: csvData\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 84\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card shadow mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-header py-3\",\n        children: /*#__PURE__*/_jsxDEV(\"h6\", {\n          className: \"m-0 font-weight-bold text-primary\",\n          children: \"Leads\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 29\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container\",\n        width: \"100%\",\n        children: leads.map(item => /*#__PURE__*/_jsxDEV(EventsTable, {\n          item: item,\n          remove: removeItem\n        }, item._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 41\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 33\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 21\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 122,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Events, \"eRocBeiSf8B1VJWINiO5gj2td28=\");\n\n_c = Events;\nexport default Leads;\n\nvar _c;\n\n$RefreshReg$(_c, \"Events\");","map":{"version":3,"sources":["/Users/akashaki/personalProjects/AdminPanel/src/components/events/Events.js"],"names":["React","useState","useEffect","config","EventsTable","CsvDownload","Events","user","BaseUrl","baseUrl","EventUrl","events","setEvents","key","JSON","parse","localStorage","getItem","fetchData","url","response","fetch","method","mode","cache","headers","resp","json","deleteItem","csvData","setCsvData","makeCSV","arr","map","item","obj","Name","first_name","Phone","phone_number","push","then","console","log","success","se","LeadUrl","Page","current","setLeads","removeItem","_id","leads","filter","lead","currentPage","count","parseInt","totalPage","setPage","Leads"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\nimport config from '../../config.json'\nimport EventsTable from './EventsTable'\nimport CsvDownload from 'react-json-to-csv'\n\nfunction Events(user) {\n        // console.log(user)\n        let BaseUrl = config.baseUrl + \"/api/events\"\n        let EventUrl = config.baseUrl + \"/api/events/all\"\n\n        const [events, setEvents] = useState([])\n        \n        let key = JSON.parse(localStorage.getItem(\"apiKey\"))\n\n        let fetchData = async(url) =>{\n            let response = await fetch(url, {\n                method: 'GET', // *GET, POST, PUT, DELETE, etc.\n                mode: 'cors', // no-cors, *cors, same-origin\n                cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n                // credentials: 'include', // include, *same-origin, omit\n                headers: {\n                  'Content-Type': 'application/json',\n                  \"Authorization\": key\n                //   'Content-Type': 'application/x-www-form-urlencoded',\n                },\n              })\n            let resp = await response.json()\n            return resp\n        }\n\n        let deleteItem = async (url) => {\n            let response = await fetch(url, {\n                method: 'DELETE', // *GET, POST, PUT, DELETE, etc.\n                mode: 'cors', // no-cors, *cors, same-origin\n                cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n                // credentials: 'include', // include, *same-origin, omit\n                headers: {\n                  'Content-Type': 'application/json',\n                  \"Authorization\": key\n                //   'Content-Type': 'application/x-www-form-urlencoded',\n                },\n              })\n            let resp = await response.json()\n            return resp\n        }\n\n        const [csvData, setCsvData] = useState([]);\n\n        async function makeCSV(response) {\n            let arr = [];\n            response.map((item)=> {\n                let obj = {};\n                obj.Name = item.first_name;\n                obj.Phone = item.phone_number;\n                arr.push(obj);\n            })\n            setCsvData(arr);\n        }\n\n        useEffect(()=>{\n            fetchData(EventUrl).then((response)=>{\n                console.log(response);\n                if (response.success) {\n\n                    let resp = response.response;\n                    \n                    makeCSV(resp);\n\n                    console.log(\"success\",response)\n                    se(response.response)\n\n            } else {\n                console.log(response)\n            }    \n        })},[])\n\n        useEffect(()=>{\n            fetchData(LeadUrl+'?page='+Page.current).then((response)=>{\n                \n                if (response.success) {\n                console.log(\"success\",response)\n                makeCSV(response.response);\n                setLeads(response.response)    \n            } else {\n                console.log(response)\n            }    \n        })},[Page])\n\n        \n        async function removeItem(item){\n            let response = await deleteItem(BaseUrl+\"/\"+item._id)\n            if(response.success){\n                setLeads(leads.filter((lead)=>lead._id !== item._id))\n                console.log(\"remove\")\n                let currentPage = Page.current\n                //checking pagination of the last item deletion in the last page\n                if ((Page.count-1) % 50 === 0 && Page.current ===  parseInt((Page.count-1)/50)) {\n                    currentPage -= 1\n                }\n\n                if (Page.count % 50 && Page.totalPage != parseInt((Page.count-1)/50)){\n                    Page.totalPage -= 1\n                }\n\n\n                setPage({\n                    count: Page.count - 1 ,\n                    current: currentPage\n                })\n            } else {\n                console.log(\"Cannot delete\")\n            }\n            \n        }\n\n        \n\n        \n\n\n    return (\n        <div className=\"container-fluid\">\n\n                    <h1 className=\"h3 mb-2 text-gray-800 heading\">Leads Table</h1> <CsvDownload data={csvData} />\n\n                    <div className=\"card shadow mb-4\">\n                        <div className=\"card-header py-3\">\n                            <h6 className=\"m-0 font-weight-bold text-primary\">Leads</h6>\n                        </div>\n                                <div className=\"container\" width=\"100%\">\n                                    \n                                    {leads.map((item)=>(\n                                        <EventsTable key={item._id} item={item} remove={removeItem}></EventsTable>\n                                    ))}\n                                </div>\n                    </div>\n\n    </div>\n                \n                \n    )\n}\n\nexport default Leads\n"]},"metadata":{},"sourceType":"module"}